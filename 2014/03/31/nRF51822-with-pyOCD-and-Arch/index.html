<!DOCTYPE html>
<!--[if IE 8]> <html lang="en" class="ie8 no-js"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9 no-js"> <![endif]-->
<!--[if !IE]><!-->
<html lang="en">
<!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <title>nRF51822 with pyOCD and Arch Board | Yihui&#39;s puzzle</title>

  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  <meta name="description" content="I’m quite excited that Bluetooth Low Energy (nRF51822) is comming to mbed. So I’m exploring what we can do with BLE (nRF51822). Preparing tools to get started with new things is always the beginning.">
<meta property="og:type" content="article">
<meta property="og:title" content="nRF51822 with pyOCD and Arch Board">
<meta property="og:url" content="http://tangram7.net/2014/03/31/nRF51822-with-pyOCD-and-Arch/index.html">
<meta property="og:site_name" content="Yihui's puzzle">
<meta property="og:description" content="I’m quite excited that Bluetooth Low Energy (nRF51822) is comming to mbed. So I’m exploring what we can do with BLE (nRF51822). Preparing tools to get started with new things is always the beginning.">
<meta property="og:image" content="http://xiongyihui.github.io/assets/images/debug_adapter.png">
<meta property="og:updated_time" content="2016-11-28T04:02:33.422Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="nRF51822 with pyOCD and Arch Board">
<meta name="twitter:description" content="I’m quite excited that Bluetooth Low Energy (nRF51822) is comming to mbed. So I’m exploring what we can do with BLE (nRF51822). Preparing tools to get started with new things is always the beginning.">
<meta name="twitter:image" content="http://xiongyihui.github.io/assets/images/debug_adapter.png">
  
  
    <link rel="icon" href="/favicon.ico">
  
    
  <meta content="{{ title }}" name="description">
  <meta content="{{ title }}" name="keywords">
  <meta content="{{ title }}" name="author">

  <link href="http://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700|PT+Sans+Narrow|Source+Sans+Pro:200,300,400,600,700,900&amp;subset=all" rel="stylesheet" type="text/css">

  <!-- Global styles START -->   
  <link rel="stylesheet" href="/metronic/assets/plugins/font-awesome/css/font-awesome.min.css">
  <link rel="stylesheet" href="/metronic/assets/plugins/bootstrap/css/bootstrap.min.css">
  <!-- Global styles END --> 
   
  <!-- Page level plugin styles START -->
  <link rel="stylesheet" href="/metronic/assets/pages/css/animate.css">
  <link rel="stylesheet" href="/metronic/assets/plugins/owl.carousel/assets/owl.carousel.css">
  <!-- Page level plugin styles END -->

  <!-- Theme styles START -->
  <link rel="stylesheet" href="/metronic/assets/pages/css/components.css">
  <link rel="stylesheet" href="/metronic/assets/pages/css/slider.css">
  <link rel="stylesheet" href="/metronic/assets/corporate/css/style.css">
  <link rel="stylesheet" href="/metronic/assets/pages/css/portfolio.css">
  <link rel="stylesheet" href="/metronic/assets/corporate/css/style-responsive.css">
  <link rel="stylesheet" href="/metronic/assets/corporate/css/themes/green.css">
  <link rel="stylesheet" href="/css/theme-styles.css">
  <!-- Theme styles END -->
</head>

<body class="corporate">
  <!-- BEGIN HEADER -->
<div class="header">
  <div class="container">
    <!--<a class="site-logo" href="/" id="logo">Yihui&#39;s puzzle</a>-->

    <a class="site-logo" href="/">
      <img src="/images/logo32.png" alt="Yihui's puzzle">
    </a>

    <a href="javascript:void(0);" class="mobi-toggler"><i class="fa fa-bars"></i></a>

    <!-- BEGIN NAVIGATION -->
    <div class="header-navigation pull-right font-transform-inherit">
      <ul>
	
	<li class="">
	  <a  href="/">Home</a>
	</li>
	
	<li class="">
	  <a  href="/projects/">Projects</a>
	</li>
	
	<li class="">
	  <a  href="/archives/">Blog</a>
	</li>
	
	<li class="">
	  <a  href="/about/">About</a>
	</li>
	
	<!-- BEGIN TOP SEARCH -->
	<li class="menu-search">
	  <span class="sep"></span>
	  <i class="fa fa-search search-btn"></i>
	  <div class="search-box">
	    <form action="#">
	      <div class="input-group">
		<input type="text" placeholder="Search" class="form-control st-default-search-input">
		<span class="input-group-btn">
		  <button class="btn btn-primary" type="submit">Search</button>
		</span>
	      </div>
	    </form>
	  </div> 
	</li>
	<!-- END TOP SEARCH -->
      </ul>
    </div>
    <!-- END NAVIGATION -->
  </div>
</div>
<!-- Header END -->

  <div class="container">
  <ul class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/archives/">Blog</a></li>
    <li class="active">Post</li>
  </ul>
  <section id="main">
    
    <h2 itemprop="name">
      <a class="article-title" href="/2014/03/31/nRF51822-with-pyOCD-and-Arch/">nRF51822 with pyOCD and Arch Board</a>
    </h2>


    <div class="row">
<div class="col-md-9 col-sm-9 blog-posts">
<article id="post-nRF51822-with-pyOCD-and-Arch" class="article article-type-post blog-item" itemscope itemprop="blogPost">
  <div class="article-meta">
  </div>
  <div class="article-inner">
    
    
    <header class="article-header">
      <ul class="blog-info">
	<li><i class="fa fa-user"></i> Yihui Xiong</li>
	<li><i class="fa fa-calendar"></i>
	  <time datetime="2014-03-30T16:00:00.000Z" itemprop="datePublished">2014/03/31</time>

	</li>
	<li class="hidden-xs"><i class="fa fa-comments"></i>
	  <a href="http://tangram7.net/2014/03/31/nRF51822-with-pyOCD-and-Arch/#disqus_thread" class="article-comment-link">Comments</a>
	</li>
	<li class="hidden-xs"><i class="fa fa-tags"></i> 
	  
  
    <a href="/tags/mbed/" title="mbed">mbed</a>,
  
    <a href="/tags/CMSIS-DAP/" title="CMSIS-DAP">CMSIS-DAP</a>,
  
    <a href="/tags/nRF51822/" title="nRF51822">nRF51822</a>
  


	</li>
      </ul>
      

    </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>I’m quite excited that Bluetooth Low Energy (nRF51822) is comming to mbed. So I’m exploring what we can do with BLE (nRF51822). Preparing tools to get started with new things is always the beginning.</p>
<p>Here we use <a href="https://github.com/mbedmicro/CMSIS-DAP" target="_blank" rel="external">CMSIS-DAP</a> and <a href="https://github.com/mbedmicro/pyOCD" target="_blank" rel="external">pyOCD</a>. <a href="https://github.com/mbedmicro/CMSIS-DAP" target="_blank" rel="external">CMSIS-DAP</a> is the software running on mbed interface to provide drag-n-drop, USB2UART communication and SWD debug. pyOCD is an Open Source python library or programming and debugging ARM Cortex-M microcontrollers using CMSIS-DAP.</p>
<p>First, use <a href="http://mbed.org/platforms/Seeeduino-Arch/" target="_blank" rel="external">Arch</a> as an mbed interface to run <a href="https://github.com/mbedmicro/CMSIS-DAP" target="_blank" rel="external">CMSIS-DAP</a>. </p>
<ol>
<li>Download <a href="https://github.com/xiongyihui/CMSIS-DAP/raw/lpc11u24/interface/mdk/lpc11u24/lpc11u24_nrf51822_if_mbed.bin" target="_blank" rel="external">mbed interface firmware for Arch</a>.</li>
<li>Connect Arch with PC, long press Arch’s button and replace firmware.bin with the new firmware in “CRP DISABLD” drive on windows. use <code>dd if=lpc11u24_nrf51822_if_mbed.bin of={path-to}/firmware.bin conv=notrunc</code> on <a href="http://mbed.org/users/seeed/notebook/programming-seeeduino-arch/" target="_blank" rel="external">Linux/Mac</a></li>
<li>Quick press the button. “MBED” drive will pop up.</li>
<li>Install the <a href="http://mbed.org/handbook/Windows-serial-configuration" target="_blank" rel="external">mbed interface driver</a> for windows to enable USB2UART function</li>
</ol>
<p><img src="http://xiongyihui.github.io/assets/images/debug_adapter.png" alt="CMSIS-DAP debug adapter"></p>
<p>Second, setup pyOCD for nRF51822. We need pyOCD, pyUSB(Linux) or pyWinUSB(Windows) and <a href="https://github.com/xiongyihui/pyOCD/raw/master/util/flash_nrf51822.py" target="_blank" rel="external">flash_nrf51822.py</a></p>
<p>On Ubuntu</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install python-setuptools</span><br><span class="line">sudo easy_install pyusb</span><br><span class="line">sudo easy_install pyocd</span><br><span class="line">wget https://github.com/xiongyihui/pyOCD/raw/master/util/flash_nrf51822.py</span><br></pre></td></tr></table></figure>
<p>On windows, install pyWinUSB instread of pyUSB.</p>
<p>Third, flash softdevice hex file or application binary file to nRF51822.</p>
<p>The softdevice hex file include two parts — Code Region 0(CR0) and User Information Configuration Registers(UICR). Here we use arm-none-eabi-objcopy to divide the hex file into two binary files for CR0 and UICR. It’s done in flash_nrf51822.py, so we just need to keep arm-none-eabi-objcop in the PATH variable. </p>
<p>To flash softdevice hex, just run<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo python flash_nrf51822.py -s softdevice.hex</span><br></pre></td></tr></table></figure></p>
<p>To flash an application binary<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo python flash_nrf51822.py -a &#123;application.bin&#125;</span><br></pre></td></tr></table></figure></p>

      
    </div>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2014/05/11/Beginning-LPC1114FN28-with-Arch-Board/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Beginning LPC1114FN28 with Arch Board
        
      </div>
    </a>
  
  
</nav>

  
  <br>
</article>



<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>
<br>


</div>
<div class="col-md-3 col-sm-3 blog-sidebar">
  <!-- CATEGORIES START -->
<h2 class="no-top-space">Categories</h2>


<!-- CATEGORIES END -->

<!-- BEGIN BLOG TAGS -->
<div class="blog-tags margin-bottom-20">
  <h2>Tags</h2>
  
  <div class="widget-wrap">
    <div class="widget">
      
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CMSIS-DAP/"><i class='fa fa-tags'></i>CMSIS-DAP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LPC1114/"><i class='fa fa-tags'></i>LPC1114</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mbed/"><i class='fa fa-tags'></i>mbed</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nRF51822/"><i class='fa fa-tags'></i>nRF51822</a></li></ul>
    </div>
  </div>


</div>
<!-- END BLOG TAGS -->


<!-- BEGIN FEATURED POSTS -->                            
<h2>Featured Posts</h2>
<div class="recent-news margin-bottom-10">
  
    
  
    
  
</div>
<!-- END FEATURED POSTS -->                            

</div>
</div>

  </section>
</div>

  
    <!-- BEGIN FOOTER -->
    <div class="footer">
      <div class="container">
        <div class="row">
          <!-- BEGIN COPYRIGHT -->
          <div class="col-md-6 col-sm-6 padding-top-10">
                  &copy; 2016 Yihui Xiong
          </div>
          <!-- END COPYRIGHT -->
	  <!-- BEGIN SOCIAL -->
<div class="col-md-6 col-sm-6">
  <ul class="social-footer list-unstyled list-inline pull-right">
    
      <li><a href="https://github.com/xiongyihui"><i class="fa fa-github"></i></a></li>
    
  </ul>  
</div>
<!-- END SOCIAL -->

        </div>
      </div>
    </div>
    <!-- END FOOTER -->

  <!-- BEGIN CORE PLUGINS (REQUIRED FOR ALL PAGES) -->
<!--[if lt IE 9]>
<script src="/metronic/assets/plugins/respond.min.js"></script>
<![endif]--> 
<script src="/metronic/assets/plugins/jquery.min.js"></script>
<script src="/metronic/assets/plugins/jquery-migrate.min.js"></script>
<script src="/metronic/assets/plugins/bootstrap/js/bootstrap.min.js"></script>
<script src="/metronic/assets/corporate/scripts/back-to-top.js"></script>
<script src="/metronic/assets/plugins/owl.carousel/owl.carousel.min.js"></script>
<script src="/metronic/assets/corporate/scripts/layout.js"></script>
<script src="/js/wow.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script type="text/javascript">
    jQuery(document).ready(function() {
        Layout.init();    
        Layout.initOWL();
        Layout.initTwitter();
        Layout.initFixHeaderWithPreHeader(); /* Switch On Header Fixing (only if you have pre-header) */
        Layout.initNavScrolling(); 
	new WOW().init();
    });
</script>
<!-- END CORE PLUGINS -->

<!-- BEGIN PAGE-SPECIFIC PLUGINS --> 







<!-- END PAGE-SPECIFIC PLUGINS --> 

<!-- BEGIN INTEGRATIONS -->



<script>
  
    var disqus_config = function () {
      this.page.url = 'http://tangram7.net/2014/03/31/nRF51822-with-pyOCD-and-Arch/';
    };
  
  (function() {  // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//tangram7.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
</script>

<script id="dsq-count-scr" src="//tangram7.disqus.com/count.js" async></script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>



<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-88107707-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


<!-- END INTEGRATIONS -->

</body>
</html>
